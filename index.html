<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Castle Hot Springs | Packages Guide</title>
<style>
  :root{
    --bg:#f6f5f2; --panel:#ffffff; --card:#ffffff; --ink:#141516; --muted:rgba(0,0,0,.64);
    --ring:rgba(15,35,35,.12); --border:rgba(15,35,35,.12); --chip:rgba(10,10,15,.05);
    --brand:#17423a; --accent:#BB705B; --shadow:0 24px 60px -30px rgba(0,0,0,.28);
    --radius:18px; --space:14px; --space-lg:18px; --space-xl:26px;
  }
  html[data-theme="dark"]{
    --bg:#0f1113; --panel:#111417; --card:#14181b; --ink:#f6f7f8; --muted:rgba(255,255,255,.72);
    --ring:rgba(243,247,248,.18); --border:rgba(243,247,248,.12); --chip:rgba(255,255,255,.08);
    --brand:#9ed0bf; --accent:#BB705B; --shadow:0 30px 70px -32px rgba(0,0,0,.6);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font:16px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; color:var(--ink); background:var(--bg);} 

  /* Topbar */
  .wrap{max-width:1150px; margin:0 auto; padding:0 var(--space-lg)}
  .top{position:sticky; top:0; z-index:10; backdrop-filter:saturate(1.1) blur(12px); background:color-mix(in oklab, var(--bg) 88%, transparent); border-bottom:1px solid var(--border)}
  h1{font-size:22px; font-weight:800; margin:0; letter-spacing:.2px; display:flex; align-items:center; gap:10px}
  .brand{color:var(--brand)}
  .title{color:var(--accent)}
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .grow{flex:1}
  .search{width:100%; padding:12px 14px; border-radius:14px; border:1px solid var(--border); background:var(--chip); color:var(--ink); outline:none; font-size:15px}
  .search:focus{box-shadow:0 0 0 4px var(--ring)}

  /* Toggle */
  .mode{width:44px; height:44px; display:flex; align-items:center; justify-content:center; border-radius:50%; border:1px solid var(--border); background:var(--chip); cursor:pointer; user-select:none; transition:background .25s}
  .mode:hover{background:color-mix(in oklab, var(--accent) 10%, var(--chip));}
  .sym{font-family:ui-sans-serif,system-ui; font-weight:700; font-size:18px; letter-spacing:.5px; line-height:1}
  .hide{display:none}

  /* Grid */
  .grid{display:grid; grid-template-columns:repeat(auto-fill, minmax(360px, 1fr)); gap:18px; padding:var(--space-xl) 0 var(--space-xl)}

  /* Card (minimal face + sticky footer) */
  .card{border:1px solid var(--border); background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; display:flex; flex-direction:column; min-height:430px}
  .cardHdr{padding:16px var(--space-lg) 8px; display:flex; gap:10px; align-items:center}
  .name{font-weight:800; font-size:18px; line-height:1.2; flex:1}
  .pill{font-size:12px; padding:4px 10px; border-radius:999px; border:1px solid var(--border); background:var(--chip); color:var(--muted)}
  .chips{padding:0 var(--space-lg) 8px; display:flex; gap:8px; flex-wrap:wrap}
  .chip{font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:color-mix(in oklab, var(--accent) 12%, var(--chip));}

  .section{padding:8px var(--space-lg)}
  .section h3{margin:0 0 6px 0; font-size:12px; letter-spacing:.08em; text-transform:uppercase; color:var(--accent)}
  .bullets{margin:0; padding-left:18px; line-height:1.5; display:-webkit-box; -webkit-line-clamp:4; -webkit-box-orient:vertical; overflow:hidden}
  .bullets li{margin:6px 0}

  .faceFooter{margin-top:auto; padding:10px var(--space-lg) var(--space-lg); display:flex; gap:10px}
  .btn{border:1px solid var(--border); background:var(--chip); color:var(--ink); padding:10px 12px; border-radius:12px; cursor:pointer; font-size:14px; flex:1}
  .btn.primary{background:color-mix(in oklab, var(--accent) 20%, var(--chip)); border-color:color-mix(in oklab, var(--accent) 40%, var(--border));}
  .btn:disabled{opacity:.55; cursor:not-allowed}

  /* Detail sheet — redesigned (Apple-y) */
  .overlay{position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:center; justify-content:center; z-index:100}
  .sheet{width:min(940px, 94vw); max-height:86vh; overflow:auto; background:var(--panel); color:var(--ink); border:1px solid var(--border); border-radius:22px; box-shadow:var(--shadow)}
  .sheetHdr{position:sticky; top:0; background:var(--panel); border-bottom:1px solid var(--border); padding:18px var(--space-lg); display:flex; gap:10px; align-items:center}
  .sheetTitle{font-size:20px; font-weight:800}
  .sheetMeta{padding:10px var(--space-lg); display:flex; gap:8px; flex-wrap:wrap}
  .meta{font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:var(--chip)}
  .sheetBody{padding:var(--space-lg); display:grid; gap:18px; grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
  .block{border:1px solid var(--border); background:color-mix(in oklab, var(--chip) 70%, transparent); border-radius:16px; padding:14px 14px}
  .block h3{margin:0 0 8px 0; font-size:12px; letter-spacing:.08em; text-transform:uppercase; color:var(--accent)}
  .block ul{margin:0; padding-left:18px; line-height:1.55}
  .block li{margin:6px 0}
  .kv{display:grid; grid-template-columns:160px 1fr; gap:8px; row-gap:6px}
  .kv .label{color:var(--muted); font-size:13px}
  .sheetFtr{position:sticky; bottom:0; background:var(--panel); border-top:1px solid var(--border); padding:12px var(--space-lg); display:flex; gap:10px}

</style>
</head>
<body>
  <div class="top">
    <div class="wrap">
      <div class="row" style="padding:14px 0">
        <h1><span class="brand">Castle Hot Springs</span><span class="title"> | Packages Guide</span></h1>
        <div class="grow"></div>
        <div class="mode" id="modeToggle" title="Toggle light/dark">
          <span class="sym" id="moon">☾</span>
          <span class="sym hide" id="sun">☀︎</span>
        </div>
      </div>
      <div class="row" style="padding:0 0 14px 0">
        <input id="q" class="search" type="text" placeholder="Whatchu lookin for..?" />
      </div>
    </div>
  </div>

  <div class="wrap">
    <div id="grid" class="grid"></div>
  </div>

  <!-- Redesigned detail sheet -->
  <div class="overlay" id="sheetOverlay" role="dialog" aria-modal="true">
    <div class="sheet">
      <div class="sheetHdr">
        <div class="sheetTitle grow" id="sheetTitle"></div>
        <button id="sheetClose" class="btn">Close</button>
      </div>
      <div class="sheetMeta" id="sheetMeta"></div>
      <div class="sheetBody" id="sheetBody"></div>
      <div class="sheetFtr" id="sheetFtr"></div>
    </div>
  </div>

<script>
const state = { theme:'light', q:'' };
const $ = s => document.querySelector(s);
$('#modeToggle').onclick = ()=>{
  state.theme = state.theme==='light'? 'dark':'light';
  document.documentElement.setAttribute('data-theme', state.theme);
  $('#moon').classList.toggle('hide', state.theme !== 'light');
  $('#sun').classList.toggle('hide', state.theme !== 'dark');
};

// Data (universal face + tailored details; no placeholder dashes inside details)
const PKG = [
  { id:'iw', cat:'Wellness', name:'Intentional Wellness', status:'active', url:'https://www.castlehotsprings.com/intentional-wellness-package/',
    includeFace:[ 'Private Wellness Sessions — 2 hours for solo traveler or 4 hours for two travelers [pr]', '$255 spa credit [pp]' ],
    chips:['3-night minimum','14+ day advance'],
    essentials:{ minNights:'3', advance:'14+ days' },
    sections:[
      { t:'What’s Included?', kind:'list', items:[ 'Private Wellness Sessions — 2 hours for solo traveler or 4 hours for two travelers [pr]', '$255 spa credit [pp]' ]}
    ]
  },
  { id:'ww', cat:'Wellness', name:'Water Wellness (Wellness Through Water)', status:'active', url:'https://www.castlehotsprings.com/promotions/wellness-through-water-package/',
    includeFace:[ '60-minute Zen Soaking Secrets [pr]', '60-minute Watsu [pp]' ],
    chips:['3-night minimum'],
    essentials:{ minNights:'3' },
    sections:[ { t:'What’s Included?', kind:'list', items:[ '60-minute Zen Soaking Secrets [pr]', '60-minute Watsu [pp]' ]} ]
  },
  { id:'ae', cat:'Adventure', name:'Adventure Experience', status:'active', url:'https://www.castlehotsprings.com/promotions/castle-adventure-package/',
    includeFace:[ 'Scenic Desert E-Bike Tour [pp]', 'Crater Canyon Exploration [pp]' ],
    chips:['3-night minimum'],
    essentials:{ minNights:'3' },
    sections:[ { t:'What’s Included?', kind:'list', items:[ 'Scenic Desert E-Bike Tour [pp]', 'Crater Canyon Exploration [pp]' ]} ]
  },
  { id:'ss', cat:'Wellness', name:'Soak & Slumber', status:'active', url:'https://www.castlehotsprings.com/promotions/soak-and-slumber-package/',
    includeFace:[ '$255 spa credit [pp]', "60-minute Private Nature's Rhythm Hike [pr]", '60-minute Divine Slumber Session [pr]' ],
    chips:['3-night minimum'],
    essentials:{ minNights:'3' },
    sections:[
      { t:'What’s Included?', kind:'list', items:[ '$255 spa credit [pp]', "60-minute Private Nature's Rhythm Hike [pr]", '60-minute Divine Slumber Session [pr]', 'Sleep Kits (placed in room at arrival)' ]},
      { t:'Kit Contents', kind:'list', items:[ 'In Room Kit [pr]: Dream Body Butter, Brochure/handout, Bath Soak, Tea', 'Personal Kit [pp]: Pillow Sachet w/ CHS Herbs, weighted cooling eye mask, copper bracelets, chocolate (one chocolate per person per night)' ]}
    ]
  },
  { id:'sor', cat:'Wellness', name:'Sonoran Oasis Renewal', status:'active', url:'https://www.castlehotsprings.com/promotions/desert-spa-package/',
    includeFace:[ '$50 per person Resort Credit [pp]', '120-minute Sonoran Desert Transformation [pp]', 'Turquoise Sage Travel Kit [pp]' ],
    chips:['3-night minimum'],
    essentials:{ minNights:'3' },
    sections:[ { t:'What’s Included?', kind:'list', items:[ '$50 per person Resort Credit (This is in addition to the $25 per person beverage credit)', 'One 120-minute Sonoran Desert Transformation per person', 'Turquoise Sage Travel Kit (One Per Person)' ]} ]
  },
  { id:'see', cat:'Culinary & Wine', name:'Sonoran Epicurean Escape', status:'active', url:'https://www.castlehotsprings.com/stay/events/sonoran-epicurean-escape/',
    includeFace:[ 'Multi-day culinary program with classes, pairings, and hosted dinners' ],
    chips:['2- or 4-night options'],
    sections:[
      { t:'What’s Included?', kind:'list', items:[ 'Multi-day culinary program with classes, pairings, and hosted dinners' ]},
      { t:'Dates Offered', kind:'list', items:[ 'November 30–December 4 (4 nights) • 2-night options: Nov 30–Dec 2 or Dec 2–Dec 4', 'December 14–December 18 (4 nights) • 2-night options: Dec 14–Dec 16 or Dec 16–Dec 18' ]},
      { t:'Itinerary', kind:'verbatim', text:`Day 1 (November 30th, December 14th) 
 - (5:30pm to 6:30pm)  Lesson in Flavor Planning & Seasonality with Executive Chef Chris Knouse and Lead Agronomist Ian Beger
 -  6:30PM - Welcome Reception and Chef’s Table Dinner

Day 2 (December 1st, December 15th:
 - (10:30am - 12:30pm) Southwest Garden Staples Cooking Class
 - (5:00pm - 6:00pm) Margarita Making Contest
 - 6:15pm Mesquite & Mezcal (Group Dinner)

Day 3 (December 2nd, December 16th):
 - (5:00pm - 6:00pm) - Herbal Tea Blending Class
 - 6:15pm - Feast at the Farm (Group Dinner)

Day 4 (December 3rd, December 17th):
 - (10:00am - 12:00pm) Prep & Plate Class
 - (5:30pm - 6:30pm) Whimsical Wine Pairings
 - 7:00pm - Sommelier’s Table & Dinner (Group Dinner)`}
    ]
  },
  { id:'vv', cat:'Culinary & Wine', name:'Vines & Vistas (Sedona Helicopter + D.A. Ranch)', status:'active', url:'https://www.castlehotsprings.com/promotions/wine-tour/',
    includeFace:[ 'Helicopter tour of Sedona & AZ wine country (≈3 hr, CHS → CHS) [pr]', 'Exclusive D.A. Ranch Estate Vineyard Tour & Wine Tasting [pr]', '$50 Resort Credit [pp]' ],
    chips:['4-night minimum','21-day advance'],
    essentials:{ minNights:'4', advance:'21 days' },
    sections:[
      { t:'What’s Included?', kind:'list', items:[ 'Helicopter Tour of Sedona & Surrounding Area including Arizona Wine Country (From Heli P/U at CHS to Heli Landing back at CHS = approx. 3 hour experience) [pr]', 'Exclusive D.A. Ranch Estate Vineyward Tour & Wine Tasting [pr]', '$50 Resort Credit Per Person (this is in addition to the $25pp per night Beverage Credit)' ]},
      { t:'Add‑Ons', kind:'list', items:[ 'Gift set $150/pp (reserve wine, D.A. Ranch olive oil, branded opener, Gayle’s Chocolates)' ]},
      { t:'Booking Notes', kind:'list', items:[ 'PA is NOT involved in booking or heli setup. Coordinated with CoyAnne.' ]},
      { t:'Essentials', kind:'kv', kv:{ 'Min Nights':'4', 'Advance':'21 days' } }
    ]
  },
  { id:'ll', cat:'Residents', name:'Local Legends (AZ Residents)', status:'active', url:'https://www.castlehotsprings.com/promotions/local-legends-offer/',
    includeFace:[ '$150 nightly resort credit PER ROOM' ],
    chips:['2-night minimum','AZ ID required'],
    essentials:{ minNights:'2', eligibility:'Valid AZ photo ID at check in' },
    sections:[
      { t:'What’s Included?', kind:'list', items:[ '$150 nightly resort credit PER ROOM' ]},
      { t:'Credit Use', kind:'list', items:[ 'Spa treatments, activities, adventures (not redeemable at Harvest, Bar 1896, the boutique, amenities or transportation)' ]},
      { t:'Quick Stay Reference', kind:'list', items:[ '2 nights → $300', '3 nights → $450', '4 nights → $600', '5 nights → $750' ]},
      { t:'Essentials', kind:'kv', kv:{ 'Min Nights':'2', 'Eligibility':'Valid AZ photo ID at check in' } }
    ]
  },
  { id:'dv', cat:'Culinary & Wine', name:'Desert Vines (Cancelled)', status:'cancelled', url:null,
    includeFace:[ '—' ], chips:['—'],
    sections:[ { t:'Status', kind:'list', items:['This package is currently cancelled.'] } ]
  }
];

function el(html){ const t=document.createElement('template'); t.innerHTML=html.trim(); return t.content.firstElementChild; }
function chipRow(chips){ if(!chips||!chips.length) return ''; return `<div class="chips">${chips.map(c=>`<span class="chip">${c}</span>`).join('')}</div>`; }
function list(items, clamp){ const arr=(items||[]).filter(x=>x && x!== '—'); const lis=arr.map(x=>`<li>${x}</li>`).join(''); if(!lis) return '<ul class="bullets"></ul>'; return `<ul class="bullets" style="${clamp?'-webkit-line-clamp:'+clamp:'-webkit-line-clamp:unset'}">${lis}</ul>`; }

function renderGrid(){
  const root = $('#grid'); root.innerHTML='';
  const q = state.q.toLowerCase();
  const data = PKG.filter(p=>{
    if(!q) return true; const hay=(p.name+' '+p.cat+' '+(p.includeFace||[]).join(' ')).toLowerCase(); return hay.includes(q);
  });
  data.forEach(p=>{
    const cancelled = p.status==='cancelled';
    const opacityVal = cancelled ? 0.85 : 1;
    const card = el(`<div class="card" style="opacity:${opacityVal}">
      <div class="cardHdr">
        <div class="name">${p.name}</div>
        ${cancelled? '<span class="pill">Cancelled</span>': `<span class="pill subtle">${p.cat}</span>`}
      </div>
      ${chipRow(p.chips)}
      <div class="section">
        <h3>What’s Included?</h3>
        ${list(p.includeFace, 4)}
      </div>
      <div class="faceFooter">
        ${p.url? `<button class="btn" data-link="${p.id}">Explore Online</button>`: '<button class="btn" disabled>Explore Online</button>'}
        <button class="btn primary" data-open="${p.id}">View Details</button>
      </div>
    </div>`);
    root.appendChild(card);
  });
}

function buildMeta(meta){
  const chips=[]; if(!meta) return chips;
  if(meta.minNights) chips.push(`Min Nights: ${meta.minNights}`);
  if(meta.advance) chips.push(`Advance: ${meta.advance}`);
  if(meta.dates) chips.push(`Dates: ${meta.dates}`);
  if(meta.eligibility) chips.push(`Eligibility: ${meta.eligibility}`);
  return chips;
}

function openSheet(pkg){
  $('#sheetTitle').textContent = pkg.name;
  const metaEl = $('#sheetMeta'); metaEl.innerHTML='';
  const body = $('#sheetBody'); body.innerHTML='';
  const ftr = $('#sheetFtr'); ftr.innerHTML='';

  // Meta chips (computed from essentials + authored chips)
  const metaChips = [...(pkg.chips||[]), ...buildMeta(pkg.essentials||{})].filter(Boolean);
  metaChips.forEach(c=> metaEl.appendChild(el(`<span class="meta">${c}</span>`)));

  // Tailored section blocks – only render sections with real content
  (pkg.sections||[]).forEach(sec=>{
    if(sec.kind==='list'){
      const items=(sec.items||[]).filter(x=>x && x!=='—');
      if(!items.length) return; // skip empty
      const block = el(`<div class="block"><h3>${sec.t}</h3><ul></ul></div>`);
      const ul = block.querySelector('ul'); items.forEach(x=> ul.appendChild(el(`<li>${x}</li>`)));
      body.appendChild(block);
    } else if(sec.kind==='kv'){
      const pairs = Object.entries(sec.kv||{}).filter(([k,v])=> v && v!=='—');
      if(!pairs.length) return;
      const block = el(`<div class="block"><h3>${sec.t}</h3><div class="kv"></div></div>`);
      const kv = block.querySelector('.kv');
      pairs.forEach(([k,v])=>{ kv.appendChild(el(`<div class="label">${k}</div>`)); kv.appendChild(el(`<div>${v}</div>`)); });
      body.appendChild(block);
    } else if(sec.kind==='verbatim'){
      const text = (sec.text||'').trim(); if(!text) return;
      const block = el(`<div class="block"><h3>${sec.t}</h3><pre style="white-space:pre-wrap; font:15px ui-sans-serif,system-ui; line-height:1.5"></pre></div>`);
      block.querySelector('pre').textContent = text; body.appendChild(block);
    }
  });

  // Sticky footer actions
  if(pkg.url){ const a=el('<button class="btn">Explore Online</button>'); a.onclick=()=>window.open(pkg.url,'_blank','noreferrer'); ftr.appendChild(a); }
  const close=el('<button class="btn primary">Done</button>'); close.onclick=()=>($('#sheetOverlay').style.display='none'); ftr.appendChild(close);

  $('#sheetOverlay').style.display='flex';
}

// Wire
document.addEventListener('click', (e)=>{
  const openId = e.target.closest('[data-open]')?.getAttribute('data-open');
  if(openId){ const pkg=PKG.find(p=>p.id===openId); if(pkg) openSheet(pkg); }
  const linkId = e.target.closest('[data-link]')?.getAttribute('data-link');
  if(linkId){ const pkg=PKG.find(p=>p.id===linkId); if(pkg && pkg.url) window.open(pkg.url,'_blank','noreferrer'); }
});
$('#sheetClose').onclick = ()=> $('#sheetOverlay').style.display='none';
$('#sheetOverlay').addEventListener('click', (e)=>{ if(e.target.id==='sheetOverlay') e.currentTarget.style.display='none'; });

$('#q').addEventListener('input', e=>{ state.q=e.target.value; renderGrid(); });

// Mount
renderGrid();
</script>
</body>
</html>
